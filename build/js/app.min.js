class Autocomplete{constructor(t,s,e){this.input=t,this.results=s,this.countries=e,this.cursor=-1,this.init()}init(){this.input.addEventListener("input",t=>{if(this.removeMatches(),this.cursor=-1,!this.input.value)return;let s=this.getMatches();Array.isArray(s)&&s.length&&this.displayMatches(s)}),this.input.addEventListener("keydown",t=>{if([13,38,40].includes(t.keyCode)&&t.preventDefault(),this.results.children.length)switch(t.keyCode){case 13:this.results.children[this.cursor].children[0].click();break;case 38:this.cursor--,this.scrollUp(),this.moveCursor();break;case 40:this.cursor++,this.moveCursor(),this.scrollDown();break;default:return}})}getMatches(){let t=[];return this.input.value&&this.countries.forEach((s,e)=>{s.substr(0,this.input.value.length).toLowerCase()===this.input.value.toLowerCase()&&t.push(s)}),t}displayMatches(t){t.forEach(t=>{let s=document.createElement("li");s.setAttribute("data-match",t),s.innerHTML="<span><strong>"+t.substring(0,this.input.value.length)+"</strong>"+t.substr(this.input.value.length)+"</span>",s.addEventListener("click",t=>{(t.target.dataset.match||t.target.parentNode.dataset.match)&&(this.input.value=t.target.dataset.match||t.target.parentNode.dataset.match,this.removeMatches())}),this.results.appendChild(s)}),this.results.parentNode.classList.remove("hidden"),this.input.classList.add("open")}removeMatches(){this.results.parentNode.classList.add("hidden"),this.input.classList.remove("open"),this.results.innerHTML=""}moveCursor(){for(let t=0;t<this.results.children.length;t++)this.results.children[t].classList.remove("highlighted");this.cursor>=this.results.children.length&&(this.cursor=0),this.cursor<0&&(this.cursor=this.results.children.length-1),this.results.children[this.cursor]&&this.results.children[this.cursor].classList.add("highlighted")}scrollUp(){this.cursor<0?this.results.scrollTop=this.results.scrollHeight:this.results.children[this.cursor].offsetHeight*this.cursor<this.results.scrollTop&&(this.results.scrollTop-=this.results.children[this.cursor].offsetHeight)}scrollDown(){0!==this.cursor?this.results.children[this.cursor].offsetHeight*this.cursor+this.results.children[this.cursor].offsetHeight>this.results.scrollTop+parseFloat(getComputedStyle(this.results,null).height.replace("px",""))&&(this.results.scrollTop+=this.results.children[this.cursor].offsetHeight):this.results.scrollTop=0}}function ready(t){"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)}function loadCountries(t){let s=new XMLHttpRequest;return new Promise((e,r)=>{s.onload=function(){this.status>=200&&this.status<300?e(s.response):r({status:this.status,statusText:this.statusText})},s.onerror=function(){r({status:this.status,statusText:this.statusText})},s.open("GET",t),s.responseType="json",s.send()})}ready(()=>{loadCountries("build/countries.json").then(t=>{new Autocomplete(document.getElementById("country"),document.getElementById("results"),t)})});